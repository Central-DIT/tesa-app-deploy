name: Docker Image Build & Push Dispatch (Backend)

on:
  repository_dispatch:
    types: [backend-update]

jobs:
  setup:
    runs-on: ubuntu-latest
    steps:
      - name: Print Environment Details
        run: echo "ðŸ“¦ Terraform Azure Deployment for all instance"

  # ---------------------- DEV ----------------------
    
  build-and-push-dev:
    name: Dev
    needs: setup
    uses: ./.github/workflows/Docker_backend_call.yml
    with:
      environment: "dev"
      image_name: ${{ github.event.client_payload.image_name }}
      image_tag: ${{ github.event.client_payload.commit_sha }}
      acr_name: ${{ github.event.client_payload.acr_name }}
      #   acr_name: ${{ vars.ACR_NAME_DEV }}   # ACR name from GitHub variable
    # secrets:
    #   azure_creds: ${{ secrets.AZURE_CREDENTIALS_DEV }}
    #   docker_env: ${{ secrets.DOCKER_ENV_DEV }}  # âœ… JSON secret for env